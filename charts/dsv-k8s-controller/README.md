# dsv-k8s-controller

![Version: v1.0.2](https://img.shields.io/badge/Version-v1.0.2-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: latest](https://img.shields.io/badge/AppVersion-latest-informational?style=flat-square)

A Helm chart for the Delinea DevOps Secrets Vault (DSV) k8 sidecar broker.
This can be installed once, or split up per namespace.
To use this you will need to use the helm chart for the `dsv-k8s-sidecar` for your service.

Install directly with helm via:

```shell
NAMESPACE='dsv'
IMAGE_REPOSITORY='docker.io/delineaxpm/dsv-k8s-controller'

helm install
    --namespace $NAMESPACE
    --create-namespace \
    --set image.repository=${IMAGE_REPOSITORY} \
    --atomic \
    --timeout "5m" \
    dsv-k8s-controller ./charts/dsv-k8s-controller
```

## Maintainers

| Name             | Email | Url |
| ---------------- | ----- | --- |
| Delinea DSV Team |       |     |

## Values

| Key                                    | Type   | Default                                                                                                                                                                      | Description                                                                                                                                                                                                |
| -------------------------------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| configmap                              | object | `{"authType":"client_credentials","clientID":null,"clientSecret":null,"dsvAPIURL":"https://%s.secretsvaultcloud.com/v1","logLevel":"info","refreshTime":"5m","tenant":null}` | configmap is the configuration for the controller.                                                                                                                                                         |
| configmap.authType                     | string | client_credentials                                                                                                                                                           | authType is the type of authentication to use with the DSV API. At this time, only `client_credentials` is supported.                                                                                      |
| configmap.clientID                     | string | `nil`                                                                                                                                                                        | clientID is the clientID provided by the generation of client credentials in DSV.                                                                                                                          |
| configmap.clientSecret                 | string | `nil`                                                                                                                                                                        | clientSecret is the clientSecret provided by the generation of client credentials in DSV.                                                                                                                  |
| configmap.dsvAPIURL                    | string | `"https://%s.secretsvaultcloud.com/v1"`                                                                                                                                      | dsvAPIURL is the URL of the DSV API. The URL should be in the format of `https://%s.secretsvaultcloud.com/v1`. The `%s` will be replaced with the tenant name in the next configuration input.             |
| configmap.logLevel                     | string | info                                                                                                                                                                         | logLevel is the log level for the sidecar                                                                                                                                                                  |
| configmap.refreshTime                  | string | 5m                                                                                                                                                                           | refreshTime is the time interval between refreshes of the secrets                                                                                                                                          |
| configmap.tenant                       | string | `nil`                                                                                                                                                                        | tenant is the name of the tenant in DSV. _REQUIRED FIELD_                                                                                                                                                  |
| fullnameOverride                       | string | `""`                                                                                                                                                                         |                                                                                                                                                                                                            |
| image                                  | object | `{"pullPolicy":"IfNotPresent","repository":"docker.io/delineaxpm/dsv-k8s-controller","tag":""}`                                                                              | image is the image configuration for the controller                                                                                                                                                        |
| image.pullPolicy                       | string | IfNotPresent                                                                                                                                                                 | pullPolicy is the image pull policy                                                                                                                                                                        |
| image.repository                       | string | docker.io/delineaxpm/dsv-k8s-controller                                                                                                                                      | repository is the name of the fully qualified image                                                                                                                                                        |
| image.tag                              | string | `""`                                                                                                                                                                         | @default '' (empty)                                                                                                                                                                                        |
| nameOverride                           | string | `""`                                                                                                                                                                         |                                                                                                                                                                                                            |
| podAnnotations                         | object | `{}`                                                                                                                                                                         |                                                                                                                                                                                                            |
| podSecurityContext                     | object | `{}`                                                                                                                                                                         |                                                                                                                                                                                                            |
| replicaCount                           | int    | `1`                                                                                                                                                                          | replicate count @default - 1                                                                                                                                                                               |
| resources                              | object | `{}`                                                                                                                                                                         |                                                                                                                                                                                                            |
| securityContext                        | object | `{"readOnlyRootFilesystem":true,"runAsGroup":65532,"runAsNonRoot":true,"runAsUser":65532}`                                                                                   | securityContext is the security context for the controller. This uses chainguard static nonroot based image. Reference: https://edu.chainguard.dev/chainguard/chainguard-images/reference/static/overview/ |
| securityContext.readOnlyRootFilesystem | bool   | true                                                                                                                                                                         | readOnlyRootFilesystem is the read only root file system flag.                                                                                                                                             |
| securityContext.runAsGroup             | int    | 65532 (from chainguard static image)                                                                                                                                         | runAsGroup is the run as group.                                                                                                                                                                            |
| securityContext.runAsNonRoot           | bool   | true                                                                                                                                                                         | runAsNonRoot is the run as non root flag.                                                                                                                                                                  |
| securityContext.runAsUser              | int    | 65532 (from chainguard static image)                                                                                                                                         | runAsUser is the run as user.                                                                                                                                                                              |
| service                                | object | `{"brokerauth":{"tcpport":80,"tcptargetPort":8080,"tlsport":443,"tlstargetPort":443},"brokergrpc":{"port":80,"targetPort":3000}}`                                            | service is the service configuration for the controller                                                                                                                                                    |
| service.brokerauth                     | object | `{"tcpport":80,"tcptargetPort":8080,"tlsport":443,"tlstargetPort":443}`                                                                                                      | brokerauth is the service configuration for the broker auth service.                                                                                                                                       |
| service.brokergrpc                     | object | `{"port":80,"targetPort":3000}`                                                                                                                                              | brokergrpc is the service configuration for the broker grpc service.                                                                                                                                       |
| strategy                               | object | `{"rollingUpdate":{"maxSurge":1,"maxUnavailable":1},"type":"RollingUpdate"}`                                                                                                 | strategy is the deployment strategy for the controller                                                                                                                                                     |
| strategy.rollingUpdate                 | object | `{"maxSurge":1,"maxUnavailable":1}`                                                                                                                                          | rollingUpdate is the rolling update configuration for the controller                                                                                                                                       |
| strategy.rollingUpdate.maxSurge        | int    | 1                                                                                                                                                                            | maxSurge is the maximum number of pods that can be created over the desired number of pods                                                                                                                 |
| strategy.rollingUpdate.maxUnavailable  | int    | 1                                                                                                                                                                            | maxUnavailable is the maximum number of pods that can be unavailable during the update                                                                                                                     |
| strategy.type                          | string | RollingUpdate                                                                                                                                                                | type is the deployment strategy type                                                                                                                                                                       |

---

Autogenerated from chart metadata using [helm-docs v1.11.0](https://github.com/norwoodj/helm-docs/releases/v1.11.0)
